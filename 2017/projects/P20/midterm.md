---
layout: page
mathjax: true
permalink: /2017/projects/p20/midterm/
---


### 一、小组成员

- **张渊** 2520170002
- **刘雨薇** 2120161018


### 二、问题与描述

房颤是最常见的心律失常之一，是由心房主导折返环引起许多小折返环导致的房律紊乱。它几乎见于所有的器质性心脏病，在非器质性心脏病也可发生。可引起严重的并发症，如心力衰竭和动脉栓塞。临床上根据房颤的发作特点，将房颤分为阵发性房颤(房颤发生时间小于7h，常小于24h,可自行转复为窦性心律)、持续性房颤(发生时间大于2天，多需电转复或药物转复)，永久性房颤(不可能转为窦性心律)。

基于单导联的房颤心率识别是临床上的一大挑战，我们希望用数据挖掘的方法改进对心电信号特征的分类，提高预测的准确性。


### 三、目标与功能

基于心电信号的时域频域特征，用支持向量机对信号分类，实现区分正常信号，房颤信号，其他节律与噪声的功能。

工作由以下几部分组成：

（1）选择数据集。ECG数据由AliveCor提供，ECG采集信号为300Hz，采集设备已经进行过初步滤波。

（2）数据预处理。训练数据长度不一，其中以30秒的居多，因此在训练模型的时候先不管短于30s的信号。超过30秒的信号截成两段。最后生成一个标准长度的训练集。

（3）特征提取。按照文献中采用的特征，提取峰均功率比和对数能熵。

（4）特征分类，用支持向量机分类，把心电信号分为正常信号，房颤信号，其他节律与噪声四类。


### 四、数据与平台

#### 数据
the PhysioNet/Computing in Cardiology Challenge 2017 官网上提供了训练集的数据。主办方的数据由AliveCor提供，ECG采集信号为300Hz，采集设备已经进行过初步滤波。所有数据以.mat的格式存储，含有.hea文件。
####平台
生理信号处理使用Matlab，其中用到滤波的包、SVM的包。统计分析使用R语言。


### 五、理论基础

#### 1. 信号处理
人体心电是一种微弱的电信号，正常人心电信号的频率范围为0.05 到100Hz，能量主要集中的范围为0.25-35Hz。它有如下特征：

（1）微弱性：通过电子设备采集到的原始心电信号很微弱，其幅值一般不超过5mV。

（2）低频特性：它的能量主要集中的范围为0.25-35Hz。属于低频信号。

（3）易受干扰：心电信号很微弱，因此在采集信号的过程中会受到很多干扰，比如测试者的状态、环境因素等。

分析心电信号首先要进行滤波。心电信号的干扰主要有三种：

（1）工频干扰
工频干扰是受测量环境中的电磁辐射的影响产生的，频率主要集中在50Hz。它使心电波形上产生规律的细小波纹，影响我们对心电的观察。

（2）肌电干扰
肌电噪声的形成是人的肌肉神经系统的活动，肌肉纤维的收缩引起物电变化，经过心电电极引导、放大就形成了肌电噪声。它属于高频噪声，主要能量集中在30~300Hz范围内，在波形上的表现为快速变化不规则波形。

（3）基线漂移
一般由采集心电的电子设备引起，呼吸干扰和运动伪迹也可引起。基线漂移属于低频干扰，频率一般小于5Hz，效果相当于在心电信号上加一个低频的正弦分量。
#### 2. 特征点的检测
基于时域波形的特征提取需要先定位主要波形的位置，如QRS波。R 波是心电信号中最突出的波形，因此可以首先对R 波进行定位，再进一步定位Q波、S 波。Pan-Tompkins方法是一种很好的R波检测算法。理论基础比较复杂。我们基于该算法，加入了回检的步骤，提高了检测R波的准确性。

#### 3. 特征提取
心电信号的特征有时域特征、变换域特征。AF病人的心电特点是RR间期绝对不规律，因此，RR间期是十分重要的特征。另，变换域如小波变换域的特征也广泛地运用于心电信号分类中。
#### 4. SVM分类


### 六、项目进展

#### 1. 信号处理
我们采用带通巴特沃斯滤波器，实现2-50Hz的滤波。

对心电信号进行分割，由于主办方提供的训练数据长度不一，其中以30秒的居多，因此在训练模型的时候先不管短于30s的信号。超过30秒的信号截成两段。最后生成一个标准长度的训练集。

#### 2. 特征提取
根据文献调研的结果，决定提取几个公认效果较好的特征：

（1）峰均功率比：

不同层的小波系数的功率谱提供ECG信号不同尺度的频谱信息，因此可用于分析心房活动。已知心房活动通常发生在4-9Hz的频率范围内。因此，在AF发作期间，预期在该频率范围内AF信号的功率更集中。

提取步骤：小波变换--> 用每一层系数小波重构

                  --> 求功率谱

                  --> 在4-9hz的范围求峰均功率比

（2）对数能熵：

熵是衡量信号复杂度与不确定性的一种度量。小波熵能让我们度量不同信号频率的复杂度与无序程度。

提取步骤：小波变换--> 用每一层系数小波重构--> 求log entropy

我们对心电信号进行6层小波分解，每层有一个高频系数一个低频系数，在对每一层尺度系数与细节系数重构后，每个系数对应一对特征。最终得到一个24维的特征矩阵。

#### 3. 对得到的特征进行初步统计分析
我们把不同组的特征最对比，希望粗略筛选出每个组区别较大的特征。如图所示，为某一层系数的峰均功率比在四组之间的盒图：
